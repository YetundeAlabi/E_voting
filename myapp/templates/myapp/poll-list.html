{% extends "base.html" %}

{%block main %}
<div class="card">
    <div class="card-body">
      <h5 class="card-title">Links and buttons</h5>

      <!-- List group with Links and buttons -->
      <div class="list-group">
        <button type="button" class="list-group-item list-group-item-action active" aria-current="true">
          The current button
        </button>
        <button type="button" class="list-group-item list-group-item-action">A second item</button>
        <button type="button" class="list-group-item list-group-item-action">A third button item</button>
        <button type="button" class="list-group-item list-group-item-action">A fourth button item</button>
        <button type="button" class="list-group-item list-group-item-action" disabled>A disabled button item</button>
      </div><!-- End List group with Links and buttons -->

    </div>
  </div>

{%end block %}
{%block script%}
<script>
    async function makeRequest() {
        try {
          const response = await fetch('http://127.0.0.1:8000/api/polls/');
      
          console.log('status code: ', response.status); // ðŸ‘‰ï¸ 200
      
          if (!response.ok) {
            console.log(response);
            throw new Error(`Error! status: ${response.status}`);
          }
          const data = await response.json();
          console.log(data);
          const pollList = document.querySelector('.list-group');
          data.forEach(poll => {
            const button = document.createElement('button');
            button.type = 'button';
            button.className = 'list-group-item list-group-item-action';
            button.textContent = poll.name;
            
            const pollId = poll.id;
            button.addEventListener('click', () => {
              window.location.href = `poll_details.html?pollId=${pollId}`;
            });
            pollList.appendChild(button);
          });
        } catch (error) {
          console.log('Error:', error);
     }
  }   
  makeRequest();
</script>
{%endscript%}